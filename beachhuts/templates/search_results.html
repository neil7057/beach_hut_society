{% extends "base.html" %}
{% block content %}

{% if not current_user.is_authenticated %}
<div class="container-fluid home-container">
  <div class="row">
    <div class="col xl-8 col-lg-8 col-md-10 mx-auto search-format">
      <div class="row">
        <div class="col-12">
          <br>
          <p class="text-sand text-center">You need to<span class="text-blue"> Signup</span>
             or <span class="text-blue"> Login</span></a>
            before you can post and comment on existing posts</p>
            <br>
        </div>
      </div>
    </div>  
  </div>
</div>
{% endif %}

<div class="container-fluid home-container"></div>
  <div class="row">
    <div class="col xl-12 col-lg-8 col-md-10 mx-auto index-format">
      <h2 class="title-color">Search Results for "{{ search_term }}"</h2>
    {% if threads %}
      <div class="row search-results forum-post">
      {% for thread in threads %}
      <div>
      <!-- <div class="thread-block"> -->
        <div class="thread-title">
          <h5>{{ thread.thread_title }}</h5>
        </div>
        <div class="thread-body">
          <p>{{ thread.thread_body }}</p>
        </div>
        <br>
        <div class="thread-tag-title">
          <p><strong>Category Tags</strong></p>
        </div>
        <div class="container-fluid">
          <div class="row justify-content-left thread-tags">
            {% set num_tags = thread.tags|length %}
            {% set col_class = 'col-4' if num_tags < 3 else 'col-3' %}
            {% for tag in thread.tags %}
            <span class="{{ col_class }} topic-badge text-center">{{ tag.tag_name }}</span>
            {% endfor %}
          </div>

        <div class="thread-author">
          <p class="text-blue">Author: <span class="font-weight-bold text-sand">{{ thread.author.username }}</span> </p>
        </div>
        <!-- Jinja templating will be used to display a series of buttons depending on user login status and author status -->
        {% if current_user.is_authenticated %}
        <a class="btn btn-primary">Reply</a>
        {% if current_user.id == thread.author_id %}
        <a href="{{url_for('edit_thread', thread_id=thread.id)}}" class="btn btn-secondary btn-edit">Edit</a>
    {% include 'delete_thread_modal.html' %}
    {% endif %}
    {% include 'comments_modal.html' %}
    {% endif %}

      </div>
      </div>
      {% endfor %}
    </div>
    </div>    
    {% else %}
    <p class="text-sand">No threads found for the given tag(s). <a href="{{url_for('tags')}}">Add your own tag</a>
       and start posting..</p>
    {% endif %}
  </div>
</div>

{% endblock %}